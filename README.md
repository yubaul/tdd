# 포인트 관리 시스템 - TDD 기반 구현

이 프로젝트는 단순한 포인트 관리 시스템을 구현하는 것이 목적이 아니라, **테스트 주도 개발(TDD)** 을 실전처럼 수행해보기 위한 학습용 과제입니다.  
각 기능은 테스트부터 작성하고, 점진적으로 설계를 개선하며 기능을 완성하는 방식으로 구현되었습니다.

### 적용한 TDD 개발 사이클

이 프로젝트는 아래 **TDD 원칙(Red-Green-Refactor)**을 기반으로 기능 구현 전 테스트부터 작성하는 방식으로 개발되었습니다.

1. **Red** – 실패하는 테스트를 먼저 작성  
   (ex: 컴파일 에러, 구현체 없음, 미정의 메서드 등)

2. **Green** – 최소한의 구현으로 테스트 통과  
   (ex: 무의미한 상수 반환이라도 좋음 → 통과가 핵심)

3. **Refactor** – 통과된 테스트를 바탕으로 구현과 테스트 코드 리팩토링  
   (ex: 책임 분리, 중복 제거, 설계 개선)

##  목적

- **TDD 실습**을 통해 테스트 코드의 역할, 단위/통합 테스트의 구분, Mock 활용법 등을 체득
- 기능보다 **설계 과정의 사고 방식**을 학습하고, 책임 분리 및 유연한 구조 설계 연습
- 실제 테스트 주도 개발 환경에서 발생할 수 있는 예외 처리, 경계 조건 등을 포괄적으로 검증
- 포인트 시스템은 단순히 연습을 위한 **도메인 수단**일 뿐, 핵심은 TDD 기반의 개발 프로세스에 있습니다


---

##  설계 방향

### 1. 아키텍처

- `Controller` → `Facade` → `Service` 흐름으로 구성
- 도메인은 `Point` 중심으로 구성
- 도메인 객체 내부에 **정책 검증 로직**을 내장해, 외부에서 검증 책임을 분산하지 않도록 설계
- `Reader`, `Store` 인터페이스를 통해 외부 저장소 의존을 추상화 (유닛 테스트에서 Mock 가능)
- `Facade`는 애플리케이션 계층의 유스케이스 조합자로 동작

### 2. 테스트 계층 구성

| 테스트 구분    | 내용 |
|---------------|------|
|  단위 테스트  | 도메인, 서비스, 컨트롤러 단위의 유닛 테스트 작성<br>Mock 기반으로 외부 의존 제거 |
|  통합 테스트  | `@SpringBootTest` 기반의 실제 의존성 주입 테스트<br>Controller와 Service 통합 검증 |
|  실패 케이스  | ID null, 음수 금액, 최대 포인트 초과, 보유 포인트 부족 등 예외 흐름 검증 |

### 3. 기타 구현 포인트

- 테스트 커버리지를 고려해 **실패 케이스까지 포함한 단위/통합 테스트** 작성
- 추후에는 `@Valid` 기반 Request 검증 로직을 Controller 단에 추가 예정
- 도메인 내부 정책 로직이 중복될 경우, 전략 객체 분리도 고려했으나 현재는 단일 책임 내 위치

---

##  테스트 실행 방법

- 기본 제공된 `UserPointTable`, `PointHistoryTable`은 `@Component`로 등록하여 **인메모리 DB** 역할로 사용
- H2 등의 외부 DB 없이 테스트 및 애플리케이션 실행 가능
- 테스트는 전체 JUnit 기반이며, 통합 테스트는 `SpringBootTest`로 구성

```bash
./gradlew test
